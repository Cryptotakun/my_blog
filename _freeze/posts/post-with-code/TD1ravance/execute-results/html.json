{
  "hash": "c7ad6980ddef0d22aa8907b41cfd8a2f",
  "result": {
    "markdown": "---\ntitle: \"TD1ravance\"\nformat: html\neditor: visual\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttachement du package : 'dplyr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLes objets suivants sont masqués depuis 'package:stats':\n\n    filter, lag\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLes objets suivants sont masqués depuis 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n:::\n\n```{.r .cell-code}\nlibrary(readxl)\nlibrary(readr)\n\ndata_ex <- read.csv(\"C:/Users/cyril/OneDrive/Documents/exercice.R/data1.csv\", sep = \";\")\ndata_ex <- na.omit(data_ex)\ntypes_data_ex <- sapply(data_ex, class)\ncat(\"Nature des colonnes :\", types_data_ex, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nNature des colonnes : character character character character \n```\n:::\n:::\n\n\nQuestion 2\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntypes_data_ex <- sapply(data_ex, class)\ncat(\"Nature des colonnes :\", types_data_ex, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nNature des colonnes : character character character character \n```\n:::\n\n```{.r .cell-code}\nnb_lignes_data_ex <- nrow(data_ex)\ncat(\"Nombre de lignes dans la data.frame :\", nb_lignes_data_ex, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nNombre de lignes dans la data.frame : 31 \n```\n:::\n\n```{.r .cell-code}\nnb_lignes_data_ex\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 31\n```\n:::\n\n```{.r .cell-code}\ntypes_data_ex\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                     geo_point                            nom \n                   \"character\"                    \"character\" \nsites_olympiques_paralympiques                         sports \n                   \"character\"                    \"character\" \n```\n:::\n:::\n\n\nQuestion 3\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnombre_sites_olympiques <- sum(data_ex$sites_olympiques_paralympiques == \"Site olympique,Site paralympique\" | data_ex$sites_olympiques_paralympiques == \"Site olympique\")\nnombre_sites_olympiques\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 26\n```\n:::\n:::\n\n\nQuestion 4\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnombre_sites_paralympiques <- sum(data_ex$sites_olympiques_paralympiques == \"Site olympique,Site paralympique\" | data_ex$sites_olympiques_paralympiques == \"Site paralympique\")\nnombre_sites_paralympiques\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 19\n```\n:::\n:::\n\n\nQuestion 5\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsites_multiples <- data_ex %>%\n  group_by(nom) %>%\n  filter(n_distinct(strsplit(sports, \",\")[[1]]) > 1) %>%\n  distinct(nom)\ncat(\"Sites avec plusieurs disciplines sportives :\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSites avec plusieurs disciplines sportives :\n```\n:::\n\n```{.r .cell-code}\ncat(sites_multiples$nom, sep = \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nStade de France\nChâteau de Versailles\nGrand Palais\nInvalides\nPont d'Iéna\nArena Bercy\nArena Paris nord\nArena Paris Sud 6 (Porte de Versailles)\nStade de la Concorde\nArena Champs de Mars\nStade Tour Eiffel\nArena La Chapelle\nCentre aquatique\nArena Paris Sud 1 (Porte de Versailles)\nArena Paris Sud 4 (Porte de Versailles)\nLa Défense Arena\nStade nautique\nVélodrome National de Saint-Quentin-en-Yvelines\nStade Roland Garros\n```\n:::\n:::\n\n\nQuestion 6\n\n\n::: {.cell}\n\n```{.r .cell-code}\nliste_sports <- strsplit(data_ex$sports, \",\")\n\ntous_les_sports <- unlist(liste_sports)\n\nsports_para_olympiques <- tous_les_sports[grep(\"Para\", tous_les_sports)]\n\ncat(\"Sports para-olympiques accueillis :\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSports para-olympiques accueillis :\n```\n:::\n\n```{.r .cell-code}\ncat(sports_para_olympiques, sep = \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nPara athlétisme\nPara équitation\nPara athlétisme\nPara taekwondo\nPara tir à l'arc\nPara judo\nPara Badminton\nPara powerlifting\nPara tennis de table\nPara natation\nPara canoë\nPara aviron\nPara cyclisme sur piste\nPara cyclisme sur route\n```\n:::\n:::\n\n\nQuestion 7\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnombre_disciplines_par_site <- data_ex %>%\n  group_by(nom) %>%\n  summarise(nombre_disciplines = n_distinct(strsplit(sports, \",\")[[1]]))\n\n\nsite_plus_disciplines <- nombre_disciplines_par_site %>%\n  filter(nombre_disciplines == max(nombre_disciplines))\n\n\ncat(\"Site(s) accueillant le plus de disciplines différentes :\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSite(s) accueillant le plus de disciplines différentes :\n```\n:::\n\n```{.r .cell-code}\ncat(site_plus_disciplines$nom, sep = \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nArena Bercy\nArena Champs de Mars\nArena La Chapelle\nArena Paris nord\nGrand Palais\nInvalides\nStade de la Concorde\nStade nautique\n```\n:::\n:::\n\n\nQuestion 8\n\n\n::: {.cell}\n\n```{.r .cell-code}\nall_sports <- unlist(strsplit(data_ex$sports, \",\"))\n\nnombre_occurrences <- table(all_sports)\n\ndiscipline_plus_sites <- names(nombre_occurrences)[which.max(nombre_occurrences)]\ncat(\"Discipline qui aura lieu sur le plus grand nombre de sites :\", discipline_plus_sites, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nDiscipline qui aura lieu sur le plus grand nombre de sites : Athlétisme \n```\n:::\n\n```{.r .cell-code}\nsites_discipline_plus_sites <- data_ex %>%\n  filter(grepl(discipline_plus_sites, sports)) %>%\n  distinct(nom)\ncat(\"Sites où cette discipline aura lieu :\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSites où cette discipline aura lieu :\n```\n:::\n\n```{.r .cell-code}\ncat(sites_discipline_plus_sites$nom, sep = \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nStade de France\nInvalides\nPont d'Iéna\nHôtel de ville de Paris\n```\n:::\n:::\n\n\nQuestion 9\n\n\n::: {.cell}\n\n```{.r .cell-code}\nall_sports <- unlist(strsplit(data_ex$sports, \",\"))\n\nnombre_occurrences <- table(all_sports)\n\ndiscipline_plus_sites <- names(nombre_occurrences)[which.max(nombre_occurrences)]\n\ncat(\"Discipline qui aura lieu sur le plus grand nombre de sites :\", discipline_plus_sites, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nDiscipline qui aura lieu sur le plus grand nombre de sites : Athlétisme \n```\n:::\n\n```{.r .cell-code}\nsites_discipline_plus_sites <- data_ex %>%\n  filter(grepl(discipline_plus_sites, sports)) %>%\n  distinct(nom)\n\n\ncat(\"Sites où cette discipline aura lieu :\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSites où cette discipline aura lieu :\n```\n:::\n\n```{.r .cell-code}\ncat(sites_discipline_plus_sites$nom, sep = \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nStade de France\nInvalides\nPont d'Iéna\nHôtel de ville de Paris\n```\n:::\n:::\n\n\nQuestion 10\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndistance_vol_oiseau <- function(coord1, coord2) {\n  lat_lon1 <- as.numeric(strsplit(coord1, \", \")[[1]])\n  lat_lon2 <- as.numeric(strsplit(coord2, \", \")[[1]])\n  \n  lat1 <- lat_lon1[1]\n  lon1 <- lat_lon1[2]\n  lat2 <- lat_lon2[1]\n  lon2 <- lat_lon2[2]\n  \n  rad <- pi/180\n  dlat <- (lat2 - lat1) * rad\n  dlon <- (lon2 - lon1) * rad\n  a <- sin(dlat/2)^2 + cos(lat1 * rad) * cos(lat2 * rad) * sin(dlon/2)^2\n  c <- 2 * atan2(sqrt(a), sqrt(1-a))\n  R <- 6371 # Rayon de la Terre en kilomètres\n  return(R * c)\n}\n\nsite1 <- \"\"\nsite2 <- \"\"\ndistance_min <- Inf\n\nfor (i in 1:(nrow(data_ex) - 1)) {\n  for (j in (i+1):nrow(data_ex)) {\n    distance <- distance_vol_oiseau(data_ex[i, \"geo_point\"], data_ex[j, \"geo_point\"])\n    if (distance < distance_min) {\n      distance_min <- distance\n      site1 <- data_ex[i, \"nom\"]\n      site2 <- data_ex[j, \"nom\"]\n    }\n  }\n}\n\ncat(\"Les deux sites les plus proches sont :\", site1, \"et\", site2, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLes deux sites les plus proches sont : Stade BMX de Saint-Quentin-en-Yvelines et Vélodrome National de Saint-Quentin-en-Yvelines \n```\n:::\n\n```{.r .cell-code}\ncat(\"Distance à vol d'oiseau entre les deux sites :\", distance_min, \"kilomètres\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nDistance à vol d'oiseau entre les deux sites : 0.0892039 kilomètres\n```\n:::\n:::\n\n\nQuestion 11\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsite1 <- \"\"\nsite2 <- \"\"\ndistance_max <- 0\n\nfor (i in 1:(nrow(data_ex) - 1)) {\n  for (j in (i+1):nrow(data_ex)) {\n    distance <- distance_vol_oiseau(data_ex[i, \"geo_point\"], data_ex[j, \"geo_point\"])\n    if (distance > distance_max) {\n      distance_max <- distance\n      site1 <- data_ex[i, \"nom\"]\n      site2 <- data_ex[j, \"nom\"]\n    }\n  }\n}\n\ncat(\"Les deux sites les plus éloignés sont :\", site1, \"et\", site2, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLes deux sites les plus éloignés sont : Colline d'Elancourt et Stade nautique \n```\n:::\n\n```{.r .cell-code}\ncat(\"Distance à vol d'oiseau entre les deux sites :\", distance_max, \"kilomètres\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nDistance à vol d'oiseau entre les deux sites : 49.63337 kilomètres\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}